# ECIES Chat Application

**Generated by Lumen Bridge Project Factory** ğŸŒ‰  
*An end-to-end encrypted chat application using ECIES and Bitcoin SV extended public keys*

## ğŸ¯ Project Overview

SecureChatApp is a privacy-focused messaging platform that implements:

- **ECIES Encryption**: Elliptic Curve Integrated Encryption Scheme for message security
- **BIP32 Extended Keys**: Hierarchical deterministic key derivation for identity
- **Handle-based Identity**: User-friendly @username@domain system
- **Multi-device Support**: Device-specific subkeys for seamless sync
- **Voice Messages**: Encrypted audio blob support
- **Real-time Delivery**: WebSocket-powered instant messaging
- **BSV Integration**: Optional payment features

## ğŸ“ Project Structure

```
ecies-chat-app/
â”œâ”€â”€ server/                      # Backend Node.js/Express application
â”‚   â”œâ”€â”€ controllers/             # Business logic
â”‚   â”‚   â”œâ”€â”€ UserIdentityManagement.js
â”‚   â”‚   â””â”€â”€ MessageStoreForward.js
â”‚   â”œâ”€â”€ routes/                  # API endpoints
â”‚   â”‚   â””â”€â”€ WebSocketService.js
â”‚   â”œâ”€â”€ models/                  # Database schemas
â”‚   â”œâ”€â”€ config/                  # Configuration files
â”‚   â””â”€â”€ utils/                   # Helper functions
â”‚
â”œâ”€â”€ src/                         # Frontend React application
â”‚   â”œâ”€â”€ components/              # React components
â”‚   â”‚   â””â”€â”€ ChatComponent.js
â”‚   â”œâ”€â”€ hooks/                   # Custom React hooks
â”‚   â”‚   â””â”€â”€ KeyVerification.js
â”‚   â”œâ”€â”€ services/                # API services
â”‚   â””â”€â”€ utils/                   # Crypto utilities
â”‚       â””â”€â”€ MessageEncryption.js
â”‚
â””â”€â”€ public/                      # Static files
```

## ğŸ› ï¸ Tech Stack

### Backend
- **Node.js** + **Express**: REST API server
- **WebSocket**: Real-time bidirectional communication
- **MongoDB** + **Mongoose**: Message and user data storage
- **elliptic**: Elliptic curve cryptography
- **crypto-js**: Additional crypto utilities

### Frontend
- **React**: UI framework
- **Axios**: HTTP client
- **noble-secp256k1**: Browser-compatible ECIES

### Crypto & Identity
- **BIP32**: Hierarchical deterministic keys
- **ECIES**: Hybrid encryption (ECDH + AES)
- **BSV SDK**: Bitcoin SV integration

## ğŸš€ Getting Started

### Prerequisites
- Node.js v16+ (v20 recommended)
- MongoDB installed and running
- npm or yarn package manager

### Installation

1. **Install dependencies:**
   ```bash
   npm install express@^4.17.1 mongoose@^5.11.15 websocket@^1.0.34 crypto-js@^4.0.0 elliptic@^6.5.3 react@^17.0.2 react-dom@^17.0.2 axios@^0.21.1 dotenv@^10.0.0 uuid@^8.3.2
   ```

2. **Configure environment:**
   Create `.env` file:
   ```env
   MONGODB_URI=mongodb://localhost:27017/ecies-chat
   PORT=3001
   WEBSOCKET_PORT=8080
   ```

3. **Start MongoDB:**
   ```bash
   mongod
   ```

4. **Run the application:**
   ```bash
   # Backend
   node server/server.js

   # Frontend (separate terminal)
   npm start
   ```

## ğŸ” Key Architecture Features

### Identity System
- Users register with `@handle@domain` format
- Extended public keys (xpub) serve as cryptographic identity
- Derivation path: `m/100'/devices/{deviceId}/chats/{chatId}`

### Message Encryption Flow
1. **Key Exchange**: ECDH between sender and recipient public keys
2. **Key Derivation**: HKDF derives symmetric session key
3. **Encryption**: AES-GCM encrypts message payload
4. **Storage**: Server stores only encrypted ciphertext

### Multi-Device Support
- Each device has unique subkey derived from master xpub
- Messages encrypted separately for each device
- Server fans out to all registered devices

## ğŸ“¡ API Endpoints

### Identity Management
- `POST /api/register` - Register new user with handle + xpub
- `GET /api/identity/:handle` - Resolve handle to identity document

### Messaging
- `POST /api/message` - Send encrypted message
- `GET /api/messages/:userId` - Retrieve queued messages

### WebSocket Events
- `connection` - Client connects
- `message` - Real-time message delivery
- `presence` - User online/offline status

## ğŸ” Generated Modules

| Module | Purpose | Location |
|--------|---------|----------|
| **UserIdentityManagement** | Handle registration, xpub storage | `server/controllers/` |
| **MessageStoreForward** | Store and forward for offline users | `server/controllers/` |
| **WebSocketService** | Real-time communication | `server/routes/` |
| **MessageEncryption** | ECIES encrypt/decrypt | `src/utils/` |
| **KeyVerification** | Fingerprint validation | `src/hooks/` |
| **ChatComponent** | Main chat UI | `src/components/` |

## ğŸ¨ Core Features Implemented

1. âœ… User identity with handle system
2. âœ… 1:1 encrypted messaging
3. âœ… Multi-device support architecture
4. âœ… Encrypted voice messaging structure
5. âœ… BSV payment integration hooks
6. âœ… Message store-and-forward server
7. âœ… Real-time delivery with WebSocket
8. âœ… Key verification/fingerprints
9. âœ… Per-message key derivation

## ğŸ”„ Next Steps

### Immediate Enhancements
- [ ] Implement Double Ratchet for forward secrecy
- [ ] Add group chat support (MLS/TreeKEM)
- [ ] Implement voice call setup (WebRTC)
- [ ] Add file/media sharing
- [ ] Create mobile apps (React Native)

### Security Improvements
- [ ] Key rotation mechanism
- [ ] Device revocation
- [ ] Backup and recovery (Shamir split)
- [ ] Key transparency logs

### Production Readiness
- [ ] Rate limiting
- [ ] Input sanitization
- [ ] Comprehensive error handling
- [ ] Logging and monitoring
- [ ] Load testing

## ğŸ“„ License

MIT

## ğŸ‘¨â€ğŸ’» Generated By

**Lumen Bridge Project Factory**  
Powered by AI agents: PromptImprover, ProjectArchitect, ChronosPlanner

**Author**: Gregory Ward (CodenLighten)  
**Date**: November 27, 2025

---

*This project was automatically generated using Lumen Bridge's intelligent agent system. The code serves as a solid foundation and should be reviewed, tested, and enhanced before production deployment.*
